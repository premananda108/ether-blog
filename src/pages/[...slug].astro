---
import { getCollection, render } from 'astro:content';

// 1. Эта функция говорит Astro, какие страницы нужно создать
export async function getStaticPaths() {
  const posts = await getCollection('blog');
  
  return posts.map(post => ({
    params: { slug: post.data.slug || post.id }, // Используем post.data.slug (например, atom-structure-part-1) или fallback на post.id
    props: post,
  }));
}

// 2. Получаем данные для текущей страницы
const post = Astro.props;
const { Content } = await render(post);
---

<!-- 3. Шаблон HTML (как будет выглядеть страница) -->
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <title>{post.data.title}</title>
  </head>
  <body>
    <main style="max-width: 800px; margin: 0 auto; padding: 20px;">
      <!-- Картинка-обложка -->
      {post.data.heroImage && <img src={post.data.heroImage} alt="" style="width:100%" />}
      
      <!-- Заголовок -->
      <h1>{post.data.title}</h1>
      
      <!-- Текст статьи -->
      <article>
        <Content />
      </article>
    </main>
  </body>
</html>