---
import { type CollectionEntry, getCollection, render } from "astro:content";
import BlogPost from "../../layouts/BlogPost.astro";

export async function getStaticPaths() {
	const posts = await getCollection("blog");

	// Фильтруем посты, которые лежат в папке src/content/blog/en/
	const enPosts = posts.filter((post) => post.id.startsWith("en/"));

	return enPosts.map((post) => {
		// Отрезаем 'en/' из пути, чтобы URL был чистым: /blog/atom-structure-part-1
		const slugBase = post.data.slug || post.id.replace(/^en\//, "");

		return {
			params: { slug: slugBase },
			props: post,
		};
	});
}

type Props = CollectionEntry<"blog">;

const post = Astro.props;
const { Content } = await render(post);
---

<BlogPost {...post.data}>
	<Content />
</BlogPost>
